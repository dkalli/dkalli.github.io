<!DOCTYPE html><html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>수학 연산 퀴즈</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-indigo-50 to-blue-100 min-h-screen flex items-center justify-center p-4">
  <div id="app" class="w-full max-w-md bg-white shadow-xl rounded-2xl p-6 space-y-6">
    <h1 class="text-2xl font-bold text-center">수학 연산 퀴즈</h1>
    <div id="quiz-area" class="space-y-4"></div>
    <button id="next-btn" class="w-full py-2 rounded-xl bg-indigo-500 text-white font-semibold disabled:opacity-40 disabled:pointer-events-none">다음 문제</button>
    <div id="result-area" class="text-center text-xl font-bold hidden"></div>
  </div>  <script>
    const BASE_QUESTIONS = 10;
    const FOCUSED_QUESTIONS = 10;
    const MIN = 1, MAX = 100;
    const ops = {
      '+': (a, b) => a + b,
      '-': (a, b) => a - b,
      '×': (a, b) => a * b,
      '÷': (a, b) => Math.floor(a / b)
    };
    const opList = Object.keys(ops);

    const state = {
      qIndex: 0,
      score: 0,
      curAnswer: null,
      phase: 'base', // 'base' → 'focus' → 'base'
      focusOp: null,
      wrongOps: []
    };

    const quizArea = document.getElementById('quiz-area');
    const nextBtn = document.getElementById('next-btn');
    const resultArea = document.getElementById('result-area');

    nextBtn.addEventListener('click', () => {
      if (state.qIndex < BASE_QUESTIONS) {
        renderQuestion();
      } else if (state.phase === 'base' && state.wrongOps.length > 0) {
        // 집중 학습(?)
        state.phase = 'focus';
        state.focusOp = state.wrongOps[0];
        state.qIndex = 0;
        state.score = 0;
        state.wrongOps = [];
        renderQuestion();
      } else if (state.phase === 'focus' && state.qIndex < FOCUSED_QUESTIONS) {
        renderQuestion();
      } else {
        resetQuiz();
      }
    });

    function randInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function genQuestion() {
      let op;
      if (state.phase === 'focus' && state.focusOp) {
        op = state.focusOp;
      } else {
        op = opList[randInt(0, opList.length - 1)];
      }

      let a = randInt(MIN, MAX);
      let b = randInt(MIN, MAX);
      if (op === '÷') {
        a = a * b;
      }

      const questionText = `${a} ${op} ${b}`;
      const correct = ops[op](a, b);
      const choices = new Set([correct]);

      while (choices.size < 4) {
        let delta = randInt(-10, 10);
        if (delta === 0) continue;
        choices.add(correct + delta);
      }

      return {
        questionText,
        correct,
        choices: Array.from(choices).sort(() => Math.random() - 0.5),
        opSymbol: op
      };
    }

    function renderQuestion() {
      const { questionText, correct, choices, opSymbol } = genQuestion();
      state.curAnswer = correct;
      state.curOp = opSymbol;

      quizArea.innerHTML = `
        <h2 class="text-center text-lg font-semibold">문제 ${state.qIndex + 1} / ${(state.phase === 'focus') ? FOCUSED_QUESTIONS : BASE_QUESTIONS}</h2>
        <p class="text-center text-xl font-bold">${questionText} = ?</p>
        <div class="grid grid-cols-2 gap-3 mt-4">
          ${choices.map((c) => `<button data-val="${c}" class="choice py-2 rounded-xl bg-indigo-100 hover:bg-indigo-200 font-medium">${c}</button>`).join('')}
        </div>
        <p id="feedback" class="mt-3 text-center text-base font-semibold"></p>
      `;

      document.querySelectorAll('.choice').forEach(btn => btn.addEventListener('click', handleChoice));
      nextBtn.disabled = true;
      resultArea.classList.add('hidden');
    }

    function handleChoice(e) {
      const val = parseInt(e.currentTarget.dataset.val);
      const feedback = document.getElementById('feedback');
      if (val === state.curAnswer) {
        state.score++;
        feedback.textContent = '정답!';
        feedback.className = 'mt-3 text-center text-green-600 font-semibold';
      } else {
        feedback.textContent = `오답! 정답은 ${state.curAnswer} (${state.curOp})`;
        feedback.className = 'mt-3 text-center text-red-600 font-semibold';
        if (state.phase === 'base') {
          state.wrongOps.push(state.curOp);
        }
      }

      document.querySelectorAll('.choice').forEach(btn => btn.disabled = true);
      nextBtn.disabled = false;
      state.qIndex++;

      if ((state.phase === 'base' && state.qIndex === BASE_QUESTIONS && state.wrongOps.length === 0) ||
          (state.phase === 'focus' && state.qIndex === FOCUSED_QUESTIONS)) {
        nextBtn.textContent = '다시 시작';
      } else if (state.phase === 'base' && state.qIndex === BASE_QUESTIONS) {
        nextBtn.textContent = `집중 학습을 시작합니다.`;
      } else {
        nextBtn.textContent = '다음 문제';
      }
    }

    function showResult() {
      quizArea.innerHTML = '';
      resultArea.textContent = `당신의 점수: ${state.score} / ${(state.phase === 'focus') ? FOCUSED_QUESTIONS : BASE_QUESTIONS}`;
      resultArea.classList.remove('hidden');
      nextBtn.textContent = '다시 시작';
      nextBtn.disabled = false;
    }

    function resetQuiz() {
      showResult();
      state.qIndex = 0;
      state.score = 0;
      state.phase = 'base';
      state.focusOp = null;
      state.wrongOps = [];
    }

    renderQuestion();
  </script></body>
</html>
